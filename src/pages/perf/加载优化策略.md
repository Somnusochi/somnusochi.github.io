---
layout: doc
outline: deep
title: 加载优化策略
---
<FlipWords :words="['加载优化策略']"/>

在现代网页开发中，优化资源加载方式是提升用户体验和页面性能的关键。部分常见的加载优化策略，包括异步加载、延迟加载、预加载技术以及动态加载方法。

## 异步加载脚本

通过使用`async`属性，可以让脚本在下载时不阻塞页面的渲染。这种方式适用于那些不依赖 DOM 或 CSSOM 的脚本，例如分析工具或跟踪脚本。

```html
 <script src="async-script.js" async></script>
```

**注意事项**：虽然`async`脚本不会阻塞页面加载，但它们会在下载完成后立即执行。这可能导致脚本在页面加载过程中运行，从而影响用户体验。因此，建议仅对非关键脚本使用 async 属性。

## 延迟加载脚本

与`async`不同，`defer`属性允许脚本在下载时不阻塞页面渲染，并且会在 HTML 完全解析后按顺序执行。这种特性使其非常适合需要操作 DOM 的脚本。

```html
<script src="defer-script.js" defer></script>
```

**注意事项**：`defer`脚本会按照其在 HTML 中的顺序执行，因此可以确保脚本之间的依赖关系得到正确处理。

## 预加载资源

为了进一步提升页面加载性能，可以通过预加载技术提前获取关键资源。以下是一些常用的预加载方法：

### Preload

`<link rel="preload">`标签用于指示浏览器提前加载当前页面即将使用的资源，例如关键的 CSS 和 JavaScript 文件。`as`属性用于指定资源类型，帮助浏览器正确处理资源优先级。

```html
<link rel="preload" href="style.css" as="style">
<link rel="preload" href="script.js" as="script">
```

**使用场景**：适用于需要在页面加载初期立即使用的资源，如关键的 CSS 和 JavaScript 文件。

### Prefetch

`<link rel="prefetch">`标签用于提前加载用户可能在将来访问的资源，这些资源会在后台加载，不会阻塞当前页面的加载。

```html
<link rel="prefetch" href="next-page.html">
<link rel="prefetch" href="image.jpg">
```

**使用场景**：适用于用户可能访问的下一页或相关资源，如导航链接或图片。

### Prerender

`<link rel="prerender">`标签用于提前渲染用户可能访问的页面，这些页面会在后台渲染，从而加快用户访问时的加载速度。

```html
<link rel="prerender" href="next-page.html">
```

**使用场景**：适用于用户可能访问的下一页，尤其是那些加载时间较长的页面。

### Preconnect

`<link rel="preconnect">`标签用于提前建立与目标服务器的连接，从而加快后续资源的加载速度。

```html
<link rel="preconnect" href="https://example.com">
```

**使用场景**：适用于需要提前建立连接的第三方资源，如 CDN 或 API 服务器。

### DNS 预解析

为了减少 DNS 解析时间，可以使用`<link rel="dns-prefetch">`标签。`<link rel="dns-prefetch">`标签用于提前解析目标服务器的域名，从而加快后续资源的加载速度。

```html
<link rel="dns-prefetch" href="https://example.com">
```

**使用场景**：适用于需要提前解析域名的第三方资源，如 CDN 或 API 服务器。

## 动态加载

在某些场景下，动态加载脚本或样式表可以进一步优化页面性能。以下是一个动态加载脚本和样式的示例：

### 动态加载脚本

```js
function loadScript(src) {
  return new Promise((resolve, reject) => {
    const script = document.createElement('script');
    script.src = src;
    script.onload = () => resolve();
    script.onerror = () => reject(new Error(`Failed to load script ${src}`));
    document.head.appendChild(script);
  });
}
```

### 动态加载样式表

```js
function loadStylesheet(src) {
  return new Promise((resolve, reject) => {
    const link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = src;
    link.onload = () => resolve();
    link.onerror = () => reject(new Error(`Failed to load stylesheet ${src}`));
    document.head.appendChild(link);
  });
}
```

**使用场景**：适用于按需加载非关键资源，例如懒加载组件或条件加载的样式。
