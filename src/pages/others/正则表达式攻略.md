---
layout: doc
outline: deep
title: 正则表达式攻略
description: 正则表达式攻略
---
<FlipWords :words="['正则表达式攻略']"/>

## 正则表达式

### 为什么要学正则表达式

1. 规则校验（如密码、手机号、身份证校验等）
2. 字符查询、替换和提取

### 正则表达式是什么

```
正则表达式是对字符串操作的一种逻辑公式，
就是用事先定义好的一些特定字符、
及这些特定字符的组合，
组成一个“规则字符串”，
这个“规则字符串”用来表达对字符串的一种过滤逻辑。
```

### 正则表达式语法

#### 字符

1. [特殊字符](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions): `+-*/()[{.\^$|\,?` 等等（无法单独使用/和其他组合在一起使用有特殊意义/单独使用匹配的不是自己）
2. 限定符: `?*+{m}{m,n}{m,}`（限制匹配字符的个数）
3. 定位符: `\b\B\^$(?=pattern)(?!pattern)`（匹配位置）

#### 优先级

下面操作符的优先级从上至下，由高到低：

```
1. 转义符 \
2. 括号和方括号 (...)、(?:...)、(?=...)、(?!...)、[...]
3. 量词限定符 {m}、{m,n}、{m,}、?、*、+
4. 位置和序列 ^(脱字符) 、$、 \元字符、 一般字符
5. 管道符（竖杠） |
```

#### 小括号的作用

1. 分组和分支 例如: `/sdsdsd(c|d|e)/`
2. 捕获内容（反向引用）例如: `![img](https://gz-public.oss-cn-shenzhen.aliyuncs.com/share/WechatIMG1.png)`
3. 非捕获内容 例如: `/abc|abd|abe/` 等同于 `/ab(?:c|d|e)/`
4. 匹配位置 例如: `/(?=pattern)/` 和 `/(?!pattern)/`（pattern 为匹配表达式）

#### [回溯原理](https://zhuanlan.zhihu.com/p/27417442)

```
回溯法也称试探法，它的基本思想是：
从问题的某一种状态（初始状态）出发，
搜索从这种状态出发所能达到的所有“状态”，
当一条路走到“尽头”的时候（不能再前进），
再后退一步或若干步，
从另一种可能“状态”出发，继续搜索，
直到所有的“路径”（状态）都试探过。
这种不断“前进”、不断“回溯”寻找解的方法，就称作“回溯法”。
```

#### 正则可视化

例如:

```js
const url = 'http://127.0.0.1:3000/v/teacher/qualification?id=2&url=http%3A%2F%2F127.0.0.1%3A3000%2Fv%2Fteacher%2Fqualification%3Fid%3D2#rrr#333';
url.match(/(?:(https?):)?\/\/([^\/:]+)(?::(\d+))?([^?]+)?(?:\?([^#]+))?(?:#(.+))?/);
```

![img](https://gz-public.oss-cn-shenzhen.aliyuncs.com/share/WechatIMG2.png) ![img](https://gz-public.oss-cn-shenzhen.aliyuncs.com/share/url.png)

### 匹配攻略

#### 1. 匹配字符

##### 模糊匹配

1. 横向模糊匹配 例如: `/a{2,}/` 单字符匹配多个
2. 纵向模糊匹配 例如: `/[abcd]/` 多种可能匹配

##### 字符组

1. `[abcd]` 常见字符组匹配 例如: `right: /[abcd]/.test('a')` `wrong: /[abcd]/.test('f')`
2. `[a-z]` 范围匹配
3. `[\^abc]` 非匹配 匹配abc之外的其他字符
4. `[\d]` 匹配特殊字符组（`\d\D\w\W\s\S`）

##### [量词](https://zhuanlan.zhihu.com/p/27417442)

1. `? * + {m} {m,n} {m,}`
2. 贪婪匹配和惰性匹配

```
贪婪模式
例如: 
'1234567890'.match(/\d{2,4}/g)  =>  ["1234", "5678", "90"]

惰性模式
例如:
'1234567890'.match(/\d{2,4}?/g)  =>  ["12", "34", "56", "78", "90"]
```

##### 分支

```
例如:
/a|b|c/  等同于 /[abc]/
```

#### 2. 匹配位置

什么是位置, 下图中箭头所指的地方就是 ![avatar](https://pic4.zhimg.com/80/v2-c487b9402a935625be4dd4b0e4f5fe5f_hd.png)

1. `^ $` 首部尾部
2. `\b \B` 单词边界 非单词边界（单词即`\w`）
3. `(?=a)` a前面的位置 `(?!a)` 除a前面的位置的其他位置

##### 小规律

```
\b 等同于  (?!\B)
\B 等同于 (?!\b)
/\b|\B/ 匹配所有位置
/(?=pattern)|(?!pattern)/  匹配所有位置（正则中的两个pattern一样）
```

##### 例如

```js
'we '.replace(/^|$/g, '#') => '#we #';
'we '.replace(/\B/g, '#') => 'w#e #';
'we '.replace(/\b/g, '#') => '#we# ';
'we '.replace(/\b|\B/g, '#') => '#w#e# #';
'we '.replace(/(?=w)/g, '#') => '#we ';
'we '.replace(/(?!w)/g, '#') => 'w#e# #';
'we '.replace(/(?!w)|(?=w)/g, '#') => '#w#e# #';
'we '.replace(/(?!we)/g, '#') => 'w#e# #';
'wewe '.replace(/(?!we)/g, '#') => 'w#ew#e# #';
'wewe '.replace(/(?!(we|ew))/g, '#') => 'wew#e# #';
```

##### 案例1 千分位

```js
'123456789'.replace(/(?!^)(?=(\d{3})+$)/g, ',') => '123,456,789';
'123456789 234565745'.replace(/\B(?=(\d{3})+\b)/g, ',') => '123,456,789 234,565,745';
```

##### 案例2 数字和大小写字母 6-12位 同时包含具体两种字符 参照[该文](https://zhuanlan.zhihu.com/p/27309508)

```js
// 正向解法 示例
const reg1 = /((?=.*[0-9])(?=.*[a-z])|(?=.*[0-9])(?=.*[A-Z])|(?=.*[a-z])(?=.*[A-Z]))^[0-9A-Za-z]{6,12}$/;

// 逆向解法示例
const reg2 = /(?!^[0-9]{6,12}$)(?!^[a-z]{6,12}$)(?!^[A-Z]{6,12}$)^[0-9A-Za-z]{6,12}$/;
```
